<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>UNIT_01_CONSOLE</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;800&display=swap');
        body { background: #000; color: #fff; font-family: 'JetBrains Mono', monospace; overflow: hidden; user-select: none; }
        .b-v { border: 1px solid #1a1a1a; }
        .active-btn { background: #fff !important; color: #000 !important; }
        .status-line { height: 2px; width: 100%; background: #111; overflow: hidden; }
        .status-progress { height: 100%; width: 30%; background: #fff; animation: move 2s linear infinite; }
        @keyframes move { from { margin-left: -30%; } to { margin-left: 100%; } }
    </style>
</head>
<body class="p-6 flex flex-col h-screen justify-between">
    <header class="flex justify-between items-start">
        <div class="space-y-1">
            <h1 class="text-sm font-extrabold tracking-tighter uppercase">Broadcast.Node.01</h1>
            <p class="text-[9px] text-zinc-600 uppercase" id="state-text">System_Standby</p>
        </div>
        <div class="text-right text-[9px] text-zinc-600 uppercase">
            <p>GPU_UTIL: <span id="gpu" class="text-white">--</span></p>
            <p>STORAGE: <span id="q" class="text-white">--</span></p>
        </div>
    </header>

    <main class="flex-grow flex flex-col justify-center">
        <div class="b-v p-6 relative">
            <div class="absolute -top-2 left-4 bg-black px-2 text-[8px] font-bold text-zinc-500 uppercase italic">Stream_Monitor</div>
            <p id="track" class="text-xs font-bold leading-tight break-all uppercase">Awaiting_Instructions</p>
            <div class="status-line mt-4 opacity-20" id="progress-bar" style="display:none;">
                <div class="status-progress"></div>
            </div>
        </div>
    </main>

    <section class="grid grid-cols-3 gap-2 mb-4">
        <button onclick="h('prev')" class="b-v py-8 flex justify-center items-center active:bg-zinc-900 transition-colors">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6L18 18V6z"/></svg>
        </button>
        <button onclick="tPlay()" id="p-btn" class="b-v py-8 flex justify-center items-center bg-white text-black active:scale-95 transition-transform">
            <svg id="p-icon" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
        </button>
        <button onclick="h('next')" class="b-v py-8 flex justify-center items-center active:bg-zinc-900 transition-colors">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M16 18h2V6h-2v12zM6 18l8.5-6L6 6z"/></svg>
        </button>
    </section>

    <footer id="log" class="text-[8px] text-zinc-800 mono h-8 overflow-hidden uppercase">
        > Console_Ready
    </footer>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.headerColor = '#000000';

        const params = new URLSearchParams(window.location.search);
        document.getElementById('gpu').innerText = (params.get('gpu') || '0') + '%';
        document.getElementById('q').innerText = (params.get('q') || '0') + '_U';
        document.getElementById('track').innerText = params.get('track') || 'STATION_IDLE';

        let playing = false;
        function h(act) {
            document.getElementById('log').innerText = `> EXECUTING_${act.toUpperCase()}...`;
            tg.sendData(JSON.stringify({ action: act }));
            tg.HapticFeedback.impactOccurred('medium');
        }

        function tPlay() {
            playing = !playing;
            const btn = document.getElementById('p-btn');
            const icon = document.getElementById('p-icon');
            const state = document.getElementById('state-text');
            const prog = document.getElementById('progress-bar');

            if(playing) {
                h('play');
                icon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>';
                btn.classList.replace('bg-white', 'border-white');
                btn.classList.replace('text-black', 'text-white');
                state.innerText = "System_Streaming";
                state.classList.replace('text-zinc-600', 'text-white');
                prog.style.display = 'block';
            } else {
                h('stop');
                icon.innerHTML = '<path d="M8 5v14l11-7z"/>';
                btn.classList.replace('border-white', 'bg-white');
                btn.classList.replace('text-white', 'text-black');
                state.innerText = "System_Standby";
                state.classList.replace('text-white', 'text-zinc-600');
                prog.style.display = 'none';
            }
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TERMINAL_v3</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
        body { background: #000; color: #fff; font-family: 'JetBrains Mono', monospace; overflow: hidden; }
        .border-v { border: 1px solid #1a1a1a; }
        .text-gray { color: #555; }
    </style>
</head>
<body class="p-6 uppercase">

    <header class="flex justify-between items-start mb-10">
        <div>
            <h1 class="text-lg font-bold tracking-tighter">BROADCAST_NODE_01</h1>
            <p class="text-[9px] text-gray">STATUS: <span id="status-text" class="text-white">STANDBY</span></p>
        </div>
        <div class="text-right text-[9px] text-gray">
            <p>GPU_CORE: <span id="gpu-val" class="text-white">--%</span></p>
            <p>QUEUE_INF: <span id="q-val" class="text-white">--_UNITS</span></p>
        </div>
    </header>

    <main class="mb-10">
        <div class="border-v p-6 relative">
            <div class="absolute top-0 left-0 bg-white text-black text-[8px] px-2 font-bold uppercase">Now_Playing</div>
            <p id="track-name" class="mt-2 text-sm font-bold truncate">AWAITING_COMMAND</p>
        </div>
    </main>

    <!-- TRANSPORT -->
    <div class="grid grid-cols-4 gap-2 mb-10">
        <button onclick="send('prev')" class="border-v h-16 flex items-center justify-center active:bg-white active:text-black transition-colors">
            <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6L18 18V6z"/></svg>
        </button>
        <button id="play-btn" onclick="togglePlay()" class="border-v h-16 col-span-2 flex items-center justify-center bg-white text-black active:scale-95 transition-transform">
            <svg id="play-icon" width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
        </button>
        <button onclick="send('next')" class="border-v h-16 flex items-center justify-center active:bg-white active:text-black transition-colors">
            <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M16 18h2V6h-2v12zM6 18l8.5-6L6 6z"/></svg>
        </button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.headerColor = '#000000';

        // ПАРСИНГ ДАННЫХ ИЗ URL
        const params = new URLSearchParams(window.location.search);
        document.getElementById('gpu-val').innerText = (params.get('gpu') || '0') + '%';
        document.getElementById('q-val').innerText = (params.get('q') || '0') + '_UNITS';
        document.getElementById('track-name').innerText = params.get('track') || 'SYSTEM_READY';

        let isPlaying = false;

        function togglePlay() {
            isPlaying = !isPlaying;
            const icon = document.getElementById('play-icon');
            const btn = document.getElementById('play-btn');
            
            if(isPlaying) {
                send('play');
                icon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>';
                btn.classList.remove('bg-white', 'text-black');
                btn.classList.add('border-white');
                document.getElementById('status-text').innerText = "STREAMING";
            } else {
                send('stop');
                icon.innerHTML = '<path d="M8 5v14l11-7z"/>';
                btn.classList.add('bg-white', 'text-black');
                document.getElementById('status-text').innerText = "STANDBY";
            }
        }

        function send(action) {
            tg.sendData(JSON.stringify({ action: action }));
        }
    </script>
</body>
</html>

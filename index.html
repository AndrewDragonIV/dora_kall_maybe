<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TERMINAL</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');
        body { background: #000; color: #fff; font-family: 'JetBrains Mono', monospace; }
        .border-main { border: 1px solid #1a1a1a; }
        .text-gray { color: #555; }
    </style>
</head>
<body class="p-6">
    <div class="flex justify-between items-start mb-10">
        <div>
            <h1 class="text-xl font-bold tracking-tighter">STREAM_OS v3</h1>
            <p class="text-[9px] text-gray">HARDWARE: NVIDIA GTX 1660 SUPER</p>
        </div>
        <button onclick="send('refresh')" class="text-[9px] border border-zinc-800 px-2 py-1 hover:bg-white hover:text-black">FETCH_NEW_CONTENT</button>
    </div>

    <div class="grid grid-cols-2 gap-4 mb-10">
        <div class="border-main p-4">
            <p class="text-[9px] text-gray mb-1">// GPU_UTIL</p>
            <p class="text-xl" id="gpu">0%</p>
        </div>
        <div class="border-main p-4">
            <p class="text-[9px] text-gray mb-1">// QUEUE_SIZE</p>
            <p class="text-xl" id="queue">SEARCHING...</p>
        </div>
    </div>

    <div class="border-main p-4 mb-10">
        <p class="text-[9px] text-gray mb-2">// NOW_STREAMING</p>
        <div class="overflow-hidden whitespace-nowrap">
            <p id="track" class="text-sm font-bold tracking-tight italic">IDLE_BY_OPERATOR</p>
        </div>
    </div>

    <!-- ТРАНСПОРТ -->
    <div class="flex justify-between gap-2 mb-10">
        <button onclick="send('prev')" class="flex-1 border-main py-8 flex justify-center hover:bg-zinc-900 active:bg-white active:text-black">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M6 18V6h2v12H6zm3.5-6L18 18V6l-8.5 6z"/></svg>
        </button>
        <button onclick="togglePlay()" id="play-btn" class="flex-[1.5] border-main py-8 flex justify-center bg-white text-black active:scale-95 transition-transform">
            <svg id="play-icon" width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
        </button>
        <button onclick="send('next')" class="flex-1 border-main py-8 flex justify-center hover:bg-zinc-900 active:bg-white active:text-black">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M16 18h2V6h-2v12zM6 18l8.5-6L6 6v12z"/></svg>
        </button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.headerColor = '#000000';

        const params = new URLSearchParams(window.location.search);
        document.getElementById('gpu').innerText = (params.get('gpu') || '0') + '%';
        document.getElementById('track').innerText = params.get('track') || 'NOT_STARTED';

        let isPlaying = false;

        function togglePlay() {
            if(!isPlaying) {
                send('play');
                document.getElementById('play-icon').innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>';
                document.getElementById('play-btn').classList.remove('bg-white', 'text-black');
                document.getElementById('play-btn').classList.add('border-white', 'text-white');
            } else {
                send('stop');
                document.getElementById('play-icon').innerHTML = '<path d="M8 5v14l11-7z"/>';
                document.getElementById('play-btn').classList.add('bg-white', 'text-black');
            }
            isPlaying = !isPlaying;
        }

        function send(action) {
            tg.sendData(JSON.stringify({ action: action }));
        }
    </script>
</body>
</html>
